!function(t,e,n){var a=!(!t.history||!history.pushState),o=0,i={},s=e.title,r={state:null,pushState:null,replaceState:null,popstate:null,stateSupport:!1},l=function(t,n){o++;var a=o.toString();n&&(e.title=n),i[a]={data:t,title:n},r.state=i[a].data},u=function(t){var e=t.indexOf("?");return-1==e?t+="?guid="+o:t=t.substring(0,e)+"?guid="+o+"&"+t.substr(e+1),t},h=function(){if(0!=o&&"function"==typeof r.popstate){r.state=null;var n=t.location.href,a=n.indexOf("guid=");if(-1!=a){n=n.substr(a+5),a=n.indexOf("&"),n=n.substring(0,-1==a?n.length:a);var l=i[n]||null;r.state=l&&l.data||null,e.title=l&&l.title||s}else e.title=s;r.popstate()}},c=function(){var n=[],a=function(){if(n){for(var t=0;n[t];t++)n[t]();n=null}},o=function(){try{e.documentElement.doScroll("left"),a()}catch(t){return void setTimeout(o,1)}};return t.addEventListener?(e.addEventListener("DOMContentLoaded",a,!1),t.addEventListener("load",a,!1)):(o(),t.attachEvent("onload",a)),function(t){n?n.push(t):t()}}();if(a){var d=history.state;history.replaceState(1,null),r.stateSupport=1==history.state,history.replaceState(d,null),r.pushState=function(e,n,a){l(e,n),t.history.pushState(null,null,u(a))},t.addEventListener?t.addEventListener("popstate",h,!1):t.attachEvent("onpopstate",h)}else{var p=(p=/msie ([\w.]+)/.exec(navigator.userAgent.toLowerCase()))?{type:"ie",version:p[1]}:null,f=!(!("onhashchange"in t)||"ie"==p.type&&(p.version<8||e.documentMode<8)),v={set:function(e){t.location.hash=e.replace(/^#*/,"")},get:function(){return t.location.hash.replace(/^#*/,"")}},g={obj:null,create:function(){g.obj=e.createElement("iframe"),g.obj.id="history_hash_frame",g.obj.src="hash.html?"+v.get(),g.obj.style.display="none",e.getElementsByTagName("body")[0].appendChild(g.obj)},addHash:function(t){g.obj.contentWindow.location.href="hash.html?"+t}};r.pushState=function(t,e,n){l(t,e);var a=u(n);f?v.set(a):(v.set(a),g.addHash(a))},r.hashHandler=function(){if(0!=o){var t=v.get(),e=g.obj.contentWindow.location.search.replace("?","");e!=t&&v.set(e),h()}},f?t.addEventListener?t.addEventListener("hashchange",h,!1):t.attachEvent("onhashchange",h):c(g.create)}t.History=r}(window,document);