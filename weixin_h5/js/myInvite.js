function getType(){var e=window.location.search,r=e.split("=")[1];return r||2}function inviteClick(e){2==e?($("header li:eq(0)").addClass("curr").next("li").removeClass("curr"),$(".border li:eq(1)").addClass("currBorder").prev().removeClass("currBorder"),$(".rewardRecords").removeClass("hide").next(".inviteRecords").addClass("hide"),$(".inviteRecords dl:not(:first)").remove(),history.replaceState({},"我的邀请","myInvite.html?type=2"),1==$(".rewardRecords dl").length&&getRecords(e)):1==e&&($("header li:eq(1)").addClass("curr").prev("li").removeClass("curr"),$(".border li:eq(0)").addClass("currBorder").next().removeClass("currBorder"),$(".inviteRecords").removeClass("hide").prev(".rewardRecords").addClass("hide"),$(".rewardRecords dl:not(:first)").remove(),history.replaceState({},"我的邀请","myInvite.html?type=1"),1==$(".inviteRecords dl").length&&getRecords(e)),_currPage=0,setTimeout(function(){myScroll.scrollTo(0,0),myScroll.refresh()},200)}function getRecords(e,r){function t(r){var t=JSON.parse(severResponse),o=t.data.int32_total,s=t.data.struct_invite_info;switch(t.code){case 0:0==o?(_pages=0,$(".rewardRecords").addClass("hide"),1==e?$(".inviteNone").removeClass("hide").find("p").text("您还没有邀请记录哦~"):2==e&&$(".inviteNone").removeClass("hide").find("p").text("您还没有奖励记录哦~")):o>0&&($(".inviteNone").addClass("hide"),_pages=Math.floor(o/10),$.each(s,function(r,t){var o=$(".rewardRecords dl:first").clone(!0).removeClass("hide");o.find("#phone").text(t.string_phone),o.find("#time").text(t.string_date),o.find("#reward").text(t.string_value),1==e?(o.find("#unit").text("积分"),$(".inviteRecords").append(o)):2==e&&$(".rewardRecords").append(o)}),setTimeout(function(){myScroll.refresh()},200)),LoadingOver();break;case-10004:case-10003:LoadingOver(),session_expired(t.msg);break;case 404:case-10002:LoadingOver(),logout();break;default:LoadingOver(),top_meassage(t.msg),show_topmessage()}}Loading(),r||(r=0);var o=urlLink+"/web/user_profile/reward_record",s="?type="+e+"&page="+r;xmlHttpRequest(s,o,t,"get")}var myScroll=null,_currPage=0,_pages=0;$(function(){document.querySelector("#wrapper").addEventListener("touchmove",function(e){e.preventDefault()},!1);var e=getType();inviteClick(e?e:2),myScroll=new IScroll("#wrapper",{mouseWheel:!0,probeType:1,vScrollbar:!1}),myScroll.on("scrollEnd",function(){-1*this.y+$(".inviteDetail").height()>$(".inviteContent").outerHeight()-108&&_currPage<_pages&&(_currPage++,getRecords(getType(),_currPage))})});