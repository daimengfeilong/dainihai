function bankInit(e){(new UploadPic).init({input:document.querySelector(".picfile-"+e),callback:function(t){var n=$("#cname-"+e).attr("src");loadwsan_datapic(t,e,n)},loading:function(){Loading()}})}function addPictureBox(){var e=[];if($(".content-box-right").each(function(t){e.push(t)}),e.length<5){num++;var t="uploadphotoJudgeZX("+num+")",n='  <div class="content-box-right" index="'+num+'" style="overflow: hidden;"> <img border=0 src="" class="cname-'+num+'" id="cname-'+num+'" style="display: none;">  <input type="file" class="picfile-'+num+'" capture="camera" accept="image/*" id="uploadphoto'+num+'" name="uploadfile" value="请点击上传图片" style="opacity: 0;height: 0;width: 0;position: absolute;"/> <div style="height: 100%;width: 100%;position: absolute;top: 0;left: 0;" onclick="'+t+'"> </div>  <div class="content-boxRight-area backImg-'+num+'">  <p><img src="images_old/liftLimit/cross.png" alt="error"></p>   <p>点击添加图片</p></div><input type="hidden" class="filname-'+num+'" value=""><div onclick="deletePicture(this)" class="delete-picture-box delete-'+num+'">   <i></i></div></div>';$(".content").append(n),resetIndex(),setTimeout(function(){bankInit(num)},1e3)}}function deletePicture(e){console.log(e),$(e).parent(".content-box-right").remove(),resetIndex();var t=$(".content").find(".content-box-right");if(4==t.length){var n=t.last(),a=n.attr("isnot");console.log("isnot == "+a),1==a&&addPictureBox()}}function resetIndex(){var e=$(".content").find(".content-box-right");e.each(function(e){$(this).attr("index",parseInt(e+1))})}function subUpload(e){if(4==e){if(1==btnstatusvalue(localStorage.int64_increase_status,3))return ShowMsg("央行征信报告已提交！"),!1}else if(5==e&&1==btnstatusvalue(localStorage.int64_increase_status,4))return ShowMsg("银行流水已提交！"),!1;var t=$(".content").find(".content-box-right");if(Loading(),""!=t&&"undefined"!=t&&null!=t)if(1==t.length){var n=$(this).find(".filname-1").val();if(""==n||"undefined"==n||null==n)LoadingOver(),ShowMsg("请添加照片！");else{var a="";t.each(function(e){var t=(parseInt(e+1),$(this).find("input[class^='filname-']").val());""!=t&&"undefined"!=t&&null!=t&&(a+="&pic_name"+parseInt(e+1)+"="+t)}),upImgs(e,a)}}else if(t.length>1){var a="";t.each(function(e){var t=(parseInt(e+1),$(this).find("input[class^='filname-']").val());""!=t&&"undefined"!=t&&null!=t&&(a+="&pic_name"+parseInt(e+1)+"="+t)}),upImgs(e,a)}}function stateBack(e){}function goBack(){window.location.href="liftLimit.html"}function upImgs(e,t){$("#loadd_pageinfog").show();var n=setTimeout(function(){LoadingOver(),top_meassage("请求超时，请稍后再试"),show_topmessage()},3e4);if(_xmlHttpRequest=createXmlHttpRequest(),null!=_xmlHttpRequest){var a=urlLink+"/web/loan/increase_limit";_xmlHttpRequest.open("POST",a,!0),_xmlHttpRequest.withCredentials=!0,_xmlHttpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),_xmlHttpRequest.onreadystatechange=function(){if(4==_xmlHttpRequest.readyState&&200==_xmlHttpRequest.status){n&&(clearTimeout(n),n=null),severResponse=_xmlHttpRequest.responseText;var e=JSON.parse(severResponse);switch(e.code){case 0:null!=e.data&&""!=e.data&&"undefined"!=e.data?goBack():ShowMsg(e.msg);break;case-10004:case-10003:session_expired(e.msg);break;case 404:case-10002:logout();break;default:top_meassage(e.msg),show_topmessage()}}},_xmlHttpRequest.send("increase_type="+e+t)}}function loadwsan_datapic(e,t,n){var a=setTimeout(function(){LoadingOver(),top_meassage("请求超时，请稍后再试"),show_topmessage()},3e4);if(_xmlHttpRequest=createXmlHttpRequest(),null!=_xmlHttpRequest){var s=urlPicLink+"/upload/bytes";_xmlHttpRequest.open("POST",s,!0),_xmlHttpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),_xmlHttpRequest.onreadystatechange=function(){if(4==_xmlHttpRequest.readyState&&200==_xmlHttpRequest.status){a&&(clearTimeout(a),a=null),severResponsepic=_xmlHttpRequest.responseText;var s=JSON.parse(severResponsepic);switch(s.result_code){case 0:$(".filname-"+t).val(s.filename),$(".backImg-"+t).hide(),$(".cname-"+t).attr("src",e),$(".cname-"+t).parent(".content-box-right").attr("isnot",1),$(".cname-"+t).show(),$(".delete-"+t).show(),get_all_status(null,null,null),null!=n&&""!=n||addPictureBox(),LoadingOver();break;default:"undefined"==s.error_message?(top_meassage("服务器忙，请稍后再试"),show_topmessage()):(top_meassage(s.error_message),show_topmessage()),LoadingOver()}}},_xmlHttpRequest.send("bytes="+e.split(",")[1]+"&type=png&encoder=urlbaes64")}}$(document).ready(function(){loadLogin_three(),get_all_status(null,null,null),setTimeout(function(){bankInit(1)},1e3),LoadingOver()});var num=1,upImgNum=0;