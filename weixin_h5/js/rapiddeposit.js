function getScore(){var t=urlLink+"/web/formalstrategyget/get";Loading(),xmlHttpRequest(null,t,getScoreSuccess,"GET")}function getScoreSuccess(t){switch(t.code){case 0:localStorage.int32_state=t.data.int32_state;var e=localStorage.int32_limit_amount;if(/rapiddeposit.html/.test(location.pathname))if($("#txt_loanmoney,#txmoneycount").attr("value",e),1==localStorage.int32_state){var a=t.data.struct_strategy_inner,n='<option alt="'+a.int32_installment_count+"_"+a.int32_installment_days+"_"+a.int32_interest+"_"+a.int32_factorage+"_"+a.int32_type+'" value="'+t.data.int32_strategy_id+'">'+t.data.string_name+t.data.struct_strategy_inner.string_description+"</option>";$("#drop_laonqx").html(n).attr("disabled","disabled"),$("#drop-img").hide(),btnOnInputVal()}else{if(2!=localStorage.int32_state&&3!=localStorage.int32_state&&5!=localStorage.int32_state)return ShowMsg(t.msg),!1;getload_gainstrategy()}/loan_desire.html/.test(location.pathname)&&(-1!==t.data.int32_cash&&-1!==t.data.int32_strategy_id&&(t.data.int32_cash&&$("#txt_loan").val(t.data.int32_cash),localStorage.int32_strategy_id=t.data.int32_strategy_id),getload_gainstrategy(gainstrategyCB)),$(".limitscore").html(localStorage.int32_limit_amount);break;case-10002:window.location.href="login.html";break;default:top_meassage(_datajson.msg),show_topmessage()}LoadingOver()}function loadget_cashcard(){Loading();var t=setTimeout(function(){LoadingOver(),top_meassage("请求超时，请稍后再试"),show_topmessage()},3e4);if(_xmlHttpRequest=createXmlHttpRequest(),null!=_xmlHttpRequest){var e=urlLink+"/web/bank_card/get_cash_card";_xmlHttpRequest.open("POST",e,!0),_xmlHttpRequest.withCredentials=!0,_xmlHttpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),_xmlHttpRequest.onreadystatechange=function(){if(4==_xmlHttpRequest.readyState&&200==_xmlHttpRequest.status){t&&(clearTimeout(t),t=null),severResponse=_xmlHttpRequest.responseText;var e=JSON.parse(severResponse);switch(e.code){case 0:LoadingOver(),$("#lbl_loancardno").val(e.data.int_card_id),$(".lbl_loancardno").html("****************"+e.data.string_card_id.substring(e.data.string_card_id.length-4));break;case-10004:case-10003:LoadingOver(),session_expired(e.msg);break;case 404:case-10002:ClearlocalSave(),LoadingOver(),window.location.href="login.html";break;default:LoadingOver(),top_meassage(e.msg),show_topmessage()}}},_xmlHttpRequest.send(null)}}function loadval(){""!=localStorage.int32_market_score&&null!=localStorage.int32_market_score&&"undefined"!=localStorage.int32_market_score&&($(".marketscore").html(localStorage.int32_market_score),parseInt(localStorage.int32_market_score)>1e3?$(".marketscoreMax").html("1000"):$(".marketscoreMax").html(localStorage.int32_market_score)),""!=localStorage.int32_market_score&&null!=localStorage.int32_market_score&&"undefined"!=localStorage.int32_market_score&&""!=localStorage.int32_limit_amount&&null!=localStorage.int32_limit_amount&&"undefined"!=localStorage.int32_limit_amount&&(parseInt(localStorage.int32_market_score)>1e3?($(".limitamount").html(parseInt(localStorage.int32_limit_amount)+parseInt(1e3)),$("#txmoneycount").val(parseInt(localStorage.int32_limit_amount)+parseInt(1e3))):($(".limitamount").html(parseInt(localStorage.int32_limit_amount)+parseInt(localStorage.int32_market_score)),$("#txmoneycount").val(parseInt(localStorage.int32_limit_amount)+parseInt(localStorage.int32_market_score))))}function btnshowtoplinmit(){1==$("#limittypec").val()?($(".marketscoreMax").html("0"),$("#txmoneycount").val(parseInt(localStorage.int32_limit_amount)),$("#limittypec").val("0"),$(".yourintegral").html('您有<span class="marketscore">'+$(".marketscore").html()+"</span>积分，点击开启兑换。"),changCash()):(parseInt(localStorage.int32_market_score)>1e3?$(".marketscoreMax").html("1000"):$(".marketscoreMax").html(localStorage.int32_market_score),$("#txmoneycount").val(parseInt(localStorage.int32_limit_amount)+parseInt(localStorage.int32_market_score)),$("#limittypec").val("1"),$(".yourintegral").html('您有<span class="marketscore">'+$(".marketscore").html()+'</span>积分，本次消耗兑换<span class="marketscoreval">0</span>积分。'),changCash())}function changCash(){var t=$(".limitscore").html(),e=$(".marketscoreMax").html(),a=parseInt(t)+parseInt(e);$(".limitamount").html(a),$("#txmoneycount").val(a),btnOnInputVal()}function tradeIntegral(){$("#limittypec").val("1"),$("#checkbox-10-2").attr("checked"),$(".yourintegral").html('您有<span class="marketscore">'+$(".marketscore").html()+'</span>积分，本次消耗兑换<span class="marketscoreval">0</span>积分。'),$(".rightcheckbox").html('<input type="checkbox" id="checkbox-10-2" checked /><label for="checkbox-10-2" onclick="btnshowtoplinmit()"></label>'),$(".top_list_frist").show(),$(".top_list_sencod").hide(),loadval(),btnOnInputVal()}function btnOnInputVal(){$("#txt_loanmoney").val();winopenloanurl()}function getload_gainstrategy(t){Loading();var e=setTimeout(function(){LoadingOver(),top_meassage("请求超时，请稍后再试"),show_topmessage()},3e4);if(_xmlHttpRequest=createXmlHttpRequest(),null!=_xmlHttpRequest){var a=urlLink+"/web/bank_card/strategy_list";_xmlHttpRequest.open("GET",a,!0),_xmlHttpRequest.withCredentials=!0,_xmlHttpRequest.onreadystatechange=function(){if(4==_xmlHttpRequest.readyState&&200==_xmlHttpRequest.status){e&&(clearTimeout(e),e=null),severResponse=_xmlHttpRequest.responseText;var a=JSON.parse(severResponse);switch(a.code){case 0:LoadingOver();var n="",o=localStorage.userBusinessType,s=localStorage.int32_product_type;null!=o||void 0!=o?1==o?($.each(a.data,function(t,e){2==e.int32_type&&(n+='<option alt="'+e.int32_installment_count+"_"+e.int32_installment_days+"_"+e.int32_interest+"_"+e.int32_factorage+"_"+e.int32_type+'" value="'+e.int32_strategy_id+'">'+e.name+"</option>")}),$("#drop_laonqx").html(n)):5==o?($.each(a.data,function(t,e){5==e.int32_type&&(n+='<option alt="'+e.int32_installment_count+"_"+e.int32_installment_days+"_"+e.int32_interest+"_"+e.int32_factorage+"_"+e.int32_type+'" value="'+e.int32_strategy_id+'">'+e.name+"</option>",/rapiddeposit.html/.test(location.pathname)&&$("#drop_laonqx").html(n))}),$("#sel_period_vip").html(n)):($.each(a.data,function(t,e){4==e.int32_type&&(n+='<option alt="'+e.int32_installment_count+"_"+e.int32_installment_days+"_"+e.int32_interest+"_"+e.int32_factorage+"_"+e.int32_type+'" value="'+e.int32_strategy_id+'">'+e.name+"</option>",/rapiddeposit.html/.test(location.pathname)&&$("#drop_laonqx").html(n))}),$("#sel_period_policyHolder").html(n)):2==s?($.each(a.data,function(t,e){2==e.int32_type&&(n+='<option alt="'+e.int32_installment_count+"_"+e.int32_installment_days+"_"+e.int32_interest+"_"+e.int32_factorage+"_"+e.int32_type+'" value="'+e.int32_strategy_id+'">'+e.name+"</option>")}),$("#drop_laonqx").html(n)):5==s?($.each(a.data,function(t,e){5==e.int32_type&&(n+='<option alt="'+e.int32_installment_count+"_"+e.int32_installment_days+"_"+e.int32_interest+"_"+e.int32_factorage+"_"+e.int32_type+'" value="'+e.int32_strategy_id+'">'+e.name+"</option>",/rapiddeposit.html/.test(location.pathname)&&$("#drop_laonqx").html(n))}),$("#sel_period_vip").html(n)):($.each(a.data,function(t,e){4==e.int32_type&&(n+='<option alt="'+e.int32_installment_count+"_"+e.int32_installment_days+"_"+e.int32_interest+"_"+e.int32_factorage+"_"+e.int32_type+'" value="'+e.int32_strategy_id+'">'+e.name+"</option>",/rapiddeposit.html/.test(location.pathname)&&$("#drop_laonqx").html(n))}),$("#sel_period_policyHolder").html(n)),btnOnInputVal(),t&&"function"==typeof t&&t();break;case-10004:case-10003:LoadingOver(),session_expired(a.msg);break;case 404:case-10002:LoadingOver(),logout();break;default:LoadingOver(),top_meassage(a.msg),show_topmessage()}}},_xmlHttpRequest.send(null)}}function changelaonmoney(){var t=$("#txt_loanmoney").val(),e=$("#txmoneycount").val();return""==t||null==t||"undefined"==t?(ShowMsg("请输入分期额度！"),!1):parseInt(t)<1e3?(ShowMsg("分期额度不能小于1000！"),!1):parseInt(t)>parseInt(e)?(ShowMsg("分期额度不能高于可使用额度！"),!1):void 0}function check_password(t){Loading();var e=setTimeout(function(){LoadingOver(),top_meassage("请求超时，请稍后再试"),show_topmessage()},3e4);if(_xmlHttpRequest=createXmlHttpRequest(),null!=_xmlHttpRequest){var a=urlLink+"/web/payment/check_password";_xmlHttpRequest.open("POST",a,!0),_xmlHttpRequest.withCredentials=!0,_xmlHttpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),_xmlHttpRequest.onreadystatechange=function(){if(4==_xmlHttpRequest.readyState&&200==_xmlHttpRequest.status){e&&(clearTimeout(e),e=null),severResponse=_xmlHttpRequest.responseText;var t=JSON.parse(severResponse);switch(t.code){case 0:LoadingOver(),divhide("payzfpwd"),$("#__w_l_h_v_c_z_e_r_o_divid").hide(),btn_sureinfo();break;case-10004:case-10003:LoadingOver(),session_expired(t.msg);break;case 404:case-10002:LoadingOver(),logout();break;case-10006:LoadingOver(),divhide("payzfpwd"),divshow("errorpwd");break;default:LoadingOver(),top_meassage(t.msg),show_topmessage()}}},_xmlHttpRequest.send("password="+t)}}function RetryPwd(){$("#txt_paypwd").val(""),$("#btnpayul").find("li").html(""),divhide("errorpwd"),divshow("payzfpwd")}function btnpaycancel(){divhide("payzfpwd"),$("#txt_paypwd").val(""),$("#btnpayul").find("li").html(""),$("#__w_l_h_v_c_z_e_r_o_divid").hide()}function RetryYZMPwd(){$("#txt_phoneyzm").val(""),$("#btnpayulo").find("li").html(""),divhide("yzmerrorpwd"),divshow("yzmpayzfpwd")}function btnyzmpaycancel(){divhide("yzmpayzfpwd"),$("#txt_phoneyzm").val(""),$("#btnpayulo").find("li").html(""),$("#__w_l_h_v_c_z_e_r_o_divid").hide()}function btn_sureinfo(){if(!$("#checkbox_a1").prop("checked"))return void top_meassage("请勾选《用户服务协议》");if(!$("#checkbox_a2").prop("checked"))return void top_meassage("请勾选保险");var t=$("#txt_loanmoney").val(),e=1*t%100,a=$("#drop_laonqx").val(),n=$("#lbl_loancardno").val(),o=$("#recent-select").val(),s=$("#txt_paypwd").val(),l=$("#txmoneycount").val(),r=btnstatusvalue(localStorage.int64_status,12);return""==t||null==t||"undefined"==t?(ShowMsg("请输入分期额度！"),!1):parseInt(t)<1e3&&2!=r?(ShowMsg("分期额度不能小于1000！"),!1):parseInt(t)<500&&2==r?(ShowMsg("分期额度不能小于500！"),!1):parseInt(t)>5e4&&1==r?(ShowMsg("分期额度不能大于50000！"),!1):parseInt(t)>5e3&&2==r?(ShowMsg("分期额度不能大于5000！"),!1):parseInt(t)>1e4&&3==r?(ShowMsg("分期额度不能大于10000！"),!1):parseInt(t)>parseInt(l)?(ShowMsg("分期额度不能高于可使用额度！"),!1):0!=e?(ShowMsg("分期额度必须是100的倍数！"),!1):"F1199"!=o?(ShowMsg("分期用途请选择个人日常消费！"),!1):""==s||null==s||"undefined"==s?(setTimeout(function(){divshow("payzfpwd"),pswClick()},500),!1):void btnsub_appkycash(t,a,n,o,s)}function pswClick(){vtype=1;var t=document.getElementById("txt_paypwd");KeyBoard(t)}function btnsub_appkycash(t,e,a,n,o){Loading();var s=setTimeout(function(){LoadingOver(),top_meassage("请求超时，请稍后再试"),show_topmessage()},7e4);if(_xmlHttpRequest=createXmlHttpRequest(),null!=_xmlHttpRequest){var l=urlLink+"/web/loan/apply_cash";_xmlHttpRequest.open("POST",l,!0),_xmlHttpRequest.withCredentials=!0,_xmlHttpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),_xmlHttpRequest.onreadystatechange=function(){if(4==_xmlHttpRequest.readyState&&200==_xmlHttpRequest.status){s&&(clearTimeout(s),s=null),severResponse=_xmlHttpRequest.responseText;var e=JSON.parse(severResponse);switch(e.code){case 0:if(4==e.data.int32_status)divshow("abuitinfosuccess"),LoadingOver();else{var a=e.data.int32_retcode;localStorage.int32_retcode=a,localStorage.ordernumber=e.data.string_order_number,-10==a?window.location.href="wap/vip_pay.html?sum="+t:null==e.data.string_contract_url||""==e.data.string_contract_url||void 0==e.data.string_contract_url?(top_meassage(e.data.string_err_msg),LoadingOver(),$("#topmeassage").show()):(localStorage.contracturl=e.data.string_contract_url.replace(/[ ]/g,"").replace(/\ +/g,"").replace(/[\r\n]/g,""),window.location.href=localStorage.contracturl),LoadingOver()}break;case-10004:case-10003:LoadingOver(),session_expired(e.msg);break;case 404:case-10002:LoadingOver(),logout();break;default:LoadingOver(),top_meassage(e.msg),show_topmessage()}}},_xmlHttpRequest.send("int32_amount="+t+"&int32_strategy_id="+e+"&int32_card_id="+a+"&string_reason="+n+"&string_pay_password="+o)}}function send_msginfo(){Loading(),$.post(urlLink+"/web/validation/send_msg",{phone_number:localStorage.string_phone_number,msg_type:3},function(t){var e=$.toJSON(t),a=jQuery.parseJSON(e);switch(a.code){case 0:LoadingOver(),top_meassage("验证码发送成功，请注意查看手机！"),show_topmessage(),RetryYZMPwd(),divshow("yzmpayzfpwd");break;default:LoadingOver(),top_meassage(a.msg),show_topmessage()}})}function send_signcontract(){Loading();var t=setTimeout(function(){LoadingOver(),top_meassage("请求超时，请稍后再试"),show_topmessage()},3e4);if(_xmlHttpRequest=createXmlHttpRequest(),null!=_xmlHttpRequest){var e=urlLink+"/web/loan/sign_contract";_xmlHttpRequest.open("POST",e,!0),_xmlHttpRequest.withCredentials=!0,_xmlHttpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),_xmlHttpRequest.onreadystatechange=function(){if(4==_xmlHttpRequest.readyState&&200==_xmlHttpRequest.status){t&&(clearTimeout(t),t=null),severResponse=_xmlHttpRequest.responseText;var e=JSON.parse(severResponse);switch(e.code){case 0:LoadingOver(),btnyzmpaycancel(),divshow("loansuccess");break;case-10004:case-10003:LoadingOver(),session_expired(e.msg);break;case 404:case-10002:LoadingOver(),logout();break;case-10018:LoadingOver(),btnyzmpaycancel(),divshow("yzmerrorpwd");break;default:LoadingOver(),top_meassage(e.msg),show_topmessage()}}},_xmlHttpRequest.send("string_order_number="+localStorage.ordernumber+"&verify_code="+$("#txt_phoneyzm").val())}}function btn_cancelcontract(){$("#cancelcontracty").hide(),Loading();var t=setTimeout(function(){LoadingOver(),top_meassage("请求超时，请稍后再试"),show_topmessage()},3e4);if(_xmlHttpRequest=createXmlHttpRequest(),null!=_xmlHttpRequest){var e=urlLink+"/web/loan/cancel_apply";_xmlHttpRequest.open("POST",e,!0),_xmlHttpRequest.withCredentials=!0,_xmlHttpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),_xmlHttpRequest.onreadystatechange=function(){if(4==_xmlHttpRequest.readyState&&200==_xmlHttpRequest.status){t&&(clearTimeout(t),t=null),severResponse=_xmlHttpRequest.responseText;var e=JSON.parse(severResponse);switch(e.code){case 0:localStorage.ordernumber="",localStorage.int32_market_score=e.data.int32_market_score,window.location.href="loanplan.html";break;case-10004:case-10003:session_expired(e.msg);break;case 404:case-10002:logout();break;default:top_meassage(e.msg),show_topmessage()}LoadingOver()}},_xmlHttpRequest.send("string_order_number="+localStorage.ordernumber)}}function btnwinopenurl(){localStorage.urllintype="kstx",window.location.href="resetpaypwd.html"}function dropLaonqx(){winopenloanurl()}function winopenloanurl(){var t=(btnstatusvalue(localStorage.int64_status,12),$("#txt_loanmoney").val());if(t=t.replace(/[^\d]/g,""),console.log(t),""==t||null==t||"undefined"==t)$("#monthlyRepayment").val("--");else{$("#topmeassage").hide();var e=$("#drop_laonqx").find("option:selected").attr("alt").split("_"),a=e[0],n=e[1],o=e[2],s=e[3],l=e[4],r=0,i=0,_=a*n,c=100*parseFloat(t),p=0==c?0:200*a;if(0==l){var m=parseFloat((o+s)*_)/1e4+1;r=parseFloat(parseFloat(c)*m+p)/100}else{var d=parseFloat(c),u=parseFloat(_),g=parseFloat(o)/1e4,h=parseFloat(s)/1e4,v=Math.pow(1+g,u),y=Math.round(d*h),w=Math.round(d*(g*v)/(v-1)*u),f=parseFloat(y)*u;r=parseFloat(w+f+p)/100}i=parseFloat(r/a),i=Math.ceil(i),r=i*a,2==l&&(i=Math.ceil(i.toFixed(2)-2)),$("#monthlyRepayment").val("￥"+i.toFixed(2))}}function closetrialbox(){$("#trial_popup_box").hide()}$(function(){loadLogin_three();var t=$("#limittypec").val(),e=$("#txt_loanmoney").val(),a=localStorage.int32_market_score;"1"==t&&""!=e&&null!=e&&"undefined"!=e?(e=parseInt(e)-parseInt(localStorage.int32_limit_amount),e<=0?$(".marketscoreval").html("0"):parseInt(e)>parseInt(a)?$(".marketscoreval").html(a):$(".marketscoreval").html(e)):$(".marketscoreval").html("0"),setTimeout(loadget_cashcard,500),getScore(),$("#txt_paypwd").val(""),$("#btnpayul").on("click",function(){vtype=1;var t=document.getElementById("txt_paypwd");KeyBoard(t)}),$("#btnpayulo").on("click",function(){vtype=8;var t=document.getElementById("txt_phoneyzm");SKeyBoard(t)}),$(document).on("click","#agreement-cl",function(){window.location.href="talk/fuyou_agreement.html"}),$(document).on("click","#agreement-weituo",function(){window.location.href="wap/entrustment.html"}),$(document).on("click","#agreement-queren",function(){window.location.href="wap/confirmation.html"}),LoadingOver()});var dItem=0;