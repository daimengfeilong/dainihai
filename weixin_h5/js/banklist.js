function yzbindinfo(){var e=GetUrlParameter("source"),t=$("#txt_bankno").val(),a=t.replace(/[ ]/g,"");a=a.trim();var n=$("#txt_khbankno").val(),s=$("#txt_paypwd").val(),r=$("#province").val(),i=$("#city").val(),o=$("#county").val();if(/#/g.test(n))return ShowMsg("不允许输入特殊字符，请重新输入！"),!1;if(""==a||null==a||"undefined"==a)return ShowMsg("请输入您的银行卡号！"),!1;var c=luhmCheck(a);if("-1"==r)return ShowMsg("请选择省份！"),!1;if(null==n||""==n)return ShowMsg("请填写开户行支行！"),!1;if(0==c){var l=$("#txt_bankno").val();if(null!=l&&"undefined"!=l||""!=l){var u=l.replace(/\s/g,"").replace(/(\d{4})(?=\d)/g,"$1 ");$("#bank_card_num").text(u)}return $("#dialog1").show(),!1}var p="";null!=r&&(p=r+"#"),null!=i&&(p+=i+"#"),p+=null!=o?o+"#":" #",bindbankno(a,p+""+n,s,e)}function dialogS(){var e=GetUrlParameter("source"),t=$("#txt_bankno").val(),a=t.replace(/[ ]/g,"");a=a.trim();var n=$("#txt_khbankno").val(),s=$("#txt_paypwd").val(),r=$("#drp_provinces").val(),i=$("#drp_city").val(),o=$("#drp_county").val(),c="";null!=r&&(c=r+"#"),null!=i&&(c+=i+"#"),c+=null!=o?o+"#":" #",bindbankno(a,c+""+n,s,e)}function bindbankno(e,t,a,n){Loading();var s=setTimeout(function(){LoadingOver(),top_meassage("请求超时，请稍后再试"),show_topmessage()},3e4);if(_xmlHttpRequest=createXmlHttpRequest(),null!=_xmlHttpRequest){var r=urlLink+"/web/bank_card/bind_card";_xmlHttpRequest.open("POST",r,!0),_xmlHttpRequest.withCredentials=!0,_xmlHttpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),_xmlHttpRequest.onreadystatechange=function(){if(4==_xmlHttpRequest.readyState&&200==_xmlHttpRequest.status){s&&(clearTimeout(s),s=null),severResponse=_xmlHttpRequest.responseText;var e=JSON.parse(severResponse);switch(e.code){case 0:window.location.href=1==n?"credit_learntruet_ds.html":"learntruet_ds.html";break;case-10004:case-10003:session_expired(e.msg);break;case 404:case-10002:logout();break;default:top_meassage(e.msg),show_topmessage()}LoadingOver()}},_xmlHttpRequest.send("card_id="+e+"&card_kno="+t+"&password="+a)}}function get_bankcard_list(){Loading();var e=setTimeout(function(){LoadingOver(),top_meassage("请求超时，请稍后再试"),show_topmessage()},3e4);if(_xmlHttpRequest=createXmlHttpRequest(),null!=_xmlHttpRequest){var t=urlLink+"/web/bank_card/get_list";_xmlHttpRequest.open("GET",t,!0),_xmlHttpRequest.withCredentials=!0,_xmlHttpRequest.onreadystatechange=function(){if(4==_xmlHttpRequest.readyState&&200==_xmlHttpRequest.status){e&&(clearTimeout(e),e=null),severResponse=_xmlHttpRequest.responseText;var t=JSON.parse(severResponse),a="";switch(t.code){case 0:""==t.data?($("#fristpage").hide(),$("#sencodpage").show()):($.each(t.data,function(e,t){var n="",s="",r="",i="",o="";if(10==t.card_type)n="<img src='images/logo_bank_credit.png'  />",s=t.bank_name,r=t.string_card_id.substring(t.string_card_id.length-4,t.string_card_id.length),i="信用卡";else switch(n='<img src="images/'+bankpictype(t.bank_type)+'" />',s=banknametype(t.bank_type),r=t.string_card_id.substring(t.string_card_id.length-4,t.string_card_id.length),i="储蓄卡",t.card_type){case 1:o='<img src="images/bank_borrow.png" />';break;case 2:o='<img src="images/bank_repay.png" />';break;case 3:o+='<img src="images/bank_repay.png" />',o+='<img src="images/bank_borrow.png" />'}a+='<div class="banklist">',a+='<div class="banklist_first">',a+='<div class="banklist_img">'+n+"</div>",a+='<div class="banklist_ztxt">',a+="<div>"+s+"</div>",a+='<div class="L-float">尾号'+r+"</div>",a+='<div class="L-float">'+i+"</div>",a+="</div>",a+='<div class="banklist_kaimg">'+o+"</div>",a+="</div>",a+="</div>"}),$(".main_banklist").html(a),$("#fristpage").show(),$("#sencodpage").hide(),$("#add-bank-card").hide());break;case-10004:case-10003:session_expired(t.msg);break;case 404:case-10002:logout();break;default:top_meassage(t.msg),show_topmessage()}LoadingOver()}},_xmlHttpRequest.send(null)}}function banknametype(e){switch(e){case 1:return"中国建设银行";case 2:return"中国银行";case 3:return"中国民生银行";case 4:return"招商银行";case 5:return"广发银行";case 6:return"兴业银行";case 7:return"中国工商银行";case 8:return"中国光大银行";case 9:return"中国邮政";case 10:return"农业银行";default:return"----"}}function bankpictype(e){switch(e){case 1:return"logo_bank_ccb.png";case 2:return"logo_bank_bc.png";case 3:return"logo_bank_cmbc.png";case 4:return"logo_bank_cmb.png";case 5:return"logo_bank_cgb.png";case 6:return"logo_bank_cib.png";case 7:return"logo_bank_icbc.png";case 8:return"logo_bank_ceb.png";case 9:return"logo_bank_psbc.png";case 10:return"logo_bank_abc.png";default:return""}}function set_repaycard(e,t){Loading();var a=setTimeout(function(){LoadingOver(),top_meassage("请求超时，请稍后再试"),show_topmessage()},3e4);if(_xmlHttpRequest=createXmlHttpRequest(),null!=_xmlHttpRequest){var n=urlLink+"/web/bank_card/set_repay_card";1==t&&(n=urlLink+"/web/bank_card/set_cash_card");_xmlHttpRequest.open("POST",n,!0),_xmlHttpRequest.withCredentials=!0,_xmlHttpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),_xmlHttpRequest.onreadystatechange=function(){if(4==_xmlHttpRequest.readyState&&200==_xmlHttpRequest.status){a&&(clearTimeout(a),a=null),severResponse=_xmlHttpRequest.responseText;var e=JSON.parse(severResponse);switch(e.code){case 0:get_bankcard_list(),ShowMsg("修改成功！");break;case-10004:case-10003:session_expired(e.msg);break;case 404:case-10002:logout();break;default:top_meassage(e.msg),show_topmessage()}LoadingOver()}},_xmlHttpRequest.send("card_id="+e)}}function delete_card(e,t){if(0!=t)return ShowMsg("不能删除处于还款卡或者分期卡状态的银行卡~"),!1;Loading();var a=setTimeout(function(){LoadingOver(),top_meassage("请求超时，请稍后再试"),show_topmessage()},3e4);if(_xmlHttpRequest=createXmlHttpRequest(),null!=_xmlHttpRequest){var n=urlLink+"/web/bank_card/delete_card";_xmlHttpRequest.open("POST",n,!0),_xmlHttpRequest.withCredentials=!0,_xmlHttpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),_xmlHttpRequest.onreadystatechange=function(){if(4==_xmlHttpRequest.readyState&&200==_xmlHttpRequest.status){a&&(clearTimeout(a),a=null),severResponse=_xmlHttpRequest.responseText;var e=JSON.parse(severResponse);switch(e.code){case 0:get_bankcard_list(),ShowMsg("删除成功！");break;case-10004:case-10003:session_expired(e.msg);break;case 404:case-10002:logout();break;default:top_meassage(e.msg),show_topmessage()}LoadingOver()}},_xmlHttpRequest.send("card_id="+e)}}function btnwinopenurl(){localStorage.urllintype="bank",window.location.href="resetpaypwd.html"}function SelectProvinces(e){$.ajax({url:"province_data.xml",dataType:"xml",type:"GET",timeout:2e3,error:function(e){},success:function(t){var a="";""!=e?$(t).find("province").each(function(t){$(this).attr("name")==e&&SelectCity(this)}):($(t).find("province").each(function(e){var t=$(this).attr("name");a+='<option value="'+t+'">'+t+"</option>",0==e&&SelectCity(this)}),$("#drp_provinces").html(a))}})}function SelectCity(e){$.ajax({url:"province_data.xml",dataType:"xml",type:"GET",timeout:2e3,error:function(e){},success:function(t){var a="";$(e).find("city").each(function(e){var t=$(this).attr("name");a+='<option value="'+t+'">'+t+"</option>",0==e&&SelectCountry(this)}),$("#drp_city").html(a)}})}function SelectCountry(e){$.ajax({url:"province_data.xml",dataType:"xml",type:"GET",timeout:2e3,error:function(e){},success:function(t){var a="";$(e).find("district").each(function(e){var t=$(this).attr("name");a+='<option value="'+t+'">'+t+"</option>"}),$("#drp_county").html(a)}})}function SelectCountry_drp(e,t){$.ajax({url:"province_data.xml",dataType:"xml",type:"GET",timeout:2e3,error:function(e){},success:function(a){$(a).find("province").each(function(a){$(this).attr("name")==e&&$(this).find("city").each(function(e){$(this).attr("name")==t&&SelectCountry(this)})})}})}